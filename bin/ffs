#!/usr/bin/env perl6

use v6;

=begin pod
FFS: Firefox Stop; stops or continues a firefox process

Usage:

    ffs --debug [stop|cont|status]
=end pod

sub MAIN($ffs-cmd = "stop", :$debug = False) {
    # extract iceweasel's process information
    my $process-info = qx{ps -u cochrane -o pid,state,command | grep '\siceweasel' | grep -v grep}.trim;
    say "Process info: $process-info" if $debug;
    my ($process-id, $process-state, $process-command) = $process-info.split(/\s+/);

    if $ffs-cmd eq "status" {
        $process-state eq "T" ?? say "Status: on hold" !! say "Status: running";
    }
    else {
        my $state-change = $ffs-cmd eq "cont" ?? "CONT" !! "STOP";

        # change the process' state
        my $kill-command = "kill -$state-change $process-id";
        $debug ?? say "Kill command: $kill-command" !! qqx{$kill-command};
    }
}

# vim: expandtab shiftwidth=4 ft=perl6
